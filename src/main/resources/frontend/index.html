<!DOCTYPE html>
<html lang="en">
<head>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>My PWA</title>
        <link rel="manifest" href="manifest.json">
    </head>

</head>
<body>
<div>это интекс gtml!</div>
<button id="notifications"> Показать уведомление</button>

<script>
    // Проверка, поддерживает ли браузер Background Sync
 if ('serviceWorker' in navigator) {
   window.addEventListener('load', () => {
     navigator.serviceWorker.register('./service-worker.js')
       .then((registration) => {
         console.log('Service Worker зарегистрирован с областью:', registration.scope);

         // После регистрации сервис-воркера, запускаем Background Sync
         registerSync();
       })
       .catch((error) => {
         console.log('Ошибка регистрации сервис-воркера:', error);
       });
   });
 }

 // Функция для регистрации синхронизации
 function registerSync() {
     navigator.serviceWorker.ready.then(swRegistration => {
         return swRegistration.sync.register('fetch-data');
     }).catch(err => {
         console.error('Ошибка регистрации синхронизации:', err);
     });
 }

 // Обработчик кнопки для запросов уведомлений
 const button = document.getElementById("notifications");
 button.addEventListener("click", () => {
     Notification.requestPermission().then((result) => {
         if (result === "granted") {
             // Запускаем синхронизацию только при разрешении на уведомления
             registerSync();
         }
     });
 });

</script>
</body>
</html>